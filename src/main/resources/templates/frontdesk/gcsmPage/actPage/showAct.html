<!doctype html>
<html lang="zxx" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <META HTTP-EQUIV='pragma' CONTENT='no-cache'>
    <META HTTP-EQUIV='Cache-Control' CONTENT='no-cache, must-revalidate'>
    <META HTTP-EQUIV='expires' CONTENT='0'>

    <link rel="stylesheet" th:href="@{/lixa/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/owl.theme.default.min.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/owl.carousel.min.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/boxicons.min.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/flaticon.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/meanmenu.min.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/animate.min.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/style.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/responsive.css}">
    <link rel="icon" type="image/png" th:href="@{/lixa/images/favicon.png}">
    <link rel="icon" href="https://img1.baidu.com/it/u=874447137,1655042583&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500" type="image/png">

    <!--layui-->
    <link rel="stylesheet" th:href="@{/layui/css/layui.css}">


    <title>ç¤¾åŒºæ´»åŠ¨</title>
</head>

<body>
<div class="preloader">
    <div class="lds-ripple">
        <div class="pl-flip-1 pl-flip-2"></div>
    </div>
</div>

<!--header start-->
<div  th:insert="~{frontdeskcommons/nav/head :: myhead}"></div>
<!--header end-->

<div>
    <h2 style="text-align: center;margin-top: 3%;margin-bottom: 3%">ç¤¾åŒºæ´»åŠ¨</h2>

    <div class="row mt-30">
        <div class="col-lg-3">
        <!--   å·¦   -->
        </div>

        <div class="col-lg-6">
            <div class="sidebar-widget search">
                <form class="search-form" th:action="@{/user/showAct}" id="actForm">
                    <input type="hidden" name="pageNum" value="1" id="sPageNum">
                    <input class="form-control" name="sActTheme" placeholder="è¯·è¾“å…¥æŸ¥æ‰¾ä¿¡æ¯..." type="text" th:value="${param.sActTheme}">
                    <button class="search-button" type="submit"><i class="bx bx-search"></i></button>
                </form>
            </div>
        </div>

        <div class="col-lg-3">
        <!--  å³ -->
        </div>
    </div>

</div>


<!--ç¤¾åŒºæ´»åŠ¨-->
<section class="best-selling-area bg-color pt-70 pb-40">
    <div class="container">
        <div class="row" >
            <div class="col-lg-3 col-sm-6" th:if="${not #lists.isEmpty(userPageAct)}" th:each="act:${userPageAct.records}">
                <div class="single-best-selling">
                    <div class="product-img">
                        <div class="product"><img th:src="${act.actImg}" alt="Image"></div>
                        <div class="product-x"><img th:src="${act.actImg}" alt="Image"></div>
                        <ul>
                            <!-- æŸ¥çœ‹ data-bs-target="#showActDtl"-->
                            <li><a href="#" data-bs-toggle="modal" th:onclick="|actDtl(${act.actId})|">
                                <i class="bx bx-show-alt"></i></a>
                            </li>
                            <!--æ”¶è—-->
                            <li><a th:onclick="|myHeart(${act.actId})|"><i class="bx bx-heart"></i></a></li>
<!--                            <li th:if="${act.heart.myHeart} != '1' and ${session.userFrontDesk?.userId} eq ${act.heart.userId} and ${session.userFrontDesk?.userName} != null"><a th:onclick="|myHeart(${act.actId})|" th:title="æ”¶è—æ´»åŠ¨"><i class="bx bx-heart"></i></a></li>-->
<!--                            <li th:if="${act.heart.myHeart} == '1' and ${session.userFrontDesk?.userId} eq ${act.heart.userId} and ${session.userFrontDesk?.userName} != null"><a th:onclick="|myHeart(${act.actId})|" th:title="å–æ¶ˆæ”¶è—"><i class="bx bxs-heart-circle"></i></a></li>-->
                        </ul>
                    </div>
                    <div class="best-selling-content">
                        <h3 th:text="${act.actTheme}"></h3>
                        <span><a th:title="æŠ¥å+${act.actTheme}+æ´»åŠ¨" style="cursor:pointer" th:onclick="|signUpAct(${act.actId})|"><i class="bx bx-location-plus"></i>æŠ¥å</a></span>
                        <b>å¯æŠ¥äººæ•°:&nbsp;[[${act.actNum}]]</b>
                        <br>
                        æ´»åŠ¨æ—¶é—´: <br>
                        [[${act.actStart}]]&nbsp;&nbsp;-&nbsp;&nbsp;[[${act.actEnd}]]
                    </div>
                </div>
            </div>

            <!-- é¡µç  -->
            <div class="col-12" th:if="${not #lists.isEmpty(userPageAct.records)}">
                <div class="pagination-area text-center">
                    <a  class="next page-numbers"  th:onclick="|doQuery(1)|">é¦–é¡µ</a>
                    <a class="next page-numbers" th:if="${userPageAct.hasPrevious()}" th:onclick="|doQuery(${userPageAct.getCurrent()-1})|"><i class="flaticon-left-arrow"></i></a>
                    <span class="" aria-current="page" th:class="${num == userPageAct.current} ?'page-numbers current':'page-numbers'"
                          th:each="num:${#numbers.sequence(1,userPageAct.pages)}">
                        <a th:onclick="|doQuery(${num})|">[[${num}]]</a>
                    </span>
                    <a  class="next page-numbers" th:if="${userPageAct.hasNext()}" th:onclick="|doQuery(${userPageAct.current+1})|"><i class="flaticon-right-arrow"></i></a>
                    <a  class="next page-numbers"  th:onclick="|doQuery(${userPageAct.pages})|">æœ«é¡µ</a>
                    <p style="text-align: center;">
                        å½“å‰ç¬¬ [[${userPageAct.current}]] é¡µ,å…± [[${userPageAct.pages }]] é¡µ,
                        æ€» [[ ${userPageAct.total }]] æ¡è®°å½•
                    </p>
                </div>
            </div>

        </div>

        <!-- æœªæŸ¥è¯¢åˆ°å†…å®¹æç¤º -->
        <div th:if="${#lists.isEmpty(userPageAct.records)}">
            <h3 style="text-align: center">æš‚æ— æ´»åŠ¨ä¿¡æ¯</h3>
        </div>

    </div>

    <!-- å•æœºçœ¼ç›æŸ¥çœ‹è¯¦ç»†æ¨¡æ€çª— -->
    <div class="modal  product-view-one" id="showActDtl">
        <div class="modal-dialog">
            <div class="modal-content"><button type="button" class="close" data-bs-dismiss="modal"><span
                    aria-hidden="true"><i class="bx bx-x"></i></span></button>
                <div class="row align-items-center">
                    <div class="col-lg-6 col-md-6">
                        <div class="product-view-one-image">
                            <div id="big" class="owl-carousel owl-theme">
                                <div class="item"><img id="actImg"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6">
                        <div class="product-content">
                            <input type="hidden" id="actIdHide">
                            <h3 >æ´»åŠ¨ä¸»é¢˜ï¼š<a id="actThemeI"></a></h3>
                            <div class=""><h4>æ´»åŠ¨æ—¶é—´:<span class="" id="actStart"></span></h4></div>
                            <br>
                            <div class=""><h4>æ´»åŠ¨ç»“æŸ:<span class="" id="actEnd"></span></h4></div>
                            <br>
                            <div class=""><h4>å¯æŠ¥åäººæ•°:&nbsp;<span  id="actNum" style="color: #fcc606;font-weight: bold"></span>&nbsp;äºº</h4></div>
                            <br>
                            <ul class="product-info">
                                <li><span>æ´»åŠ¨ä»‹ç»:ğŸ‘‡ğŸ‘‡ğŸ‘‡</span></li>
                                <li>
                                    <p id="actDtl" style="border:1px solid #ccc;"></p>
                                </li>
                            </ul>
                            <div class="product-add-to-cart" style="margin-top: 6%">
                                <button type="button" class="default-btn" style="cursor:pointer" th:onclick="|signUpActModel()|"> æŠ¥å <i class="flaticon-right"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</section>
<!--ä¼˜äº«æœåŠ¡-->

<!--footer start-->
<div th:insert="~{frontdeskcommons/nav/footer :: myfooter}"></div>
<!--footer end é¡µè„šã€é¡µè„šé¡µé¢å†…å®¹-->

<!--LayUI-->
<script th:src="@{/layui/layui.all.js}"></script>

<!--èƒŒæ™¯åŠ¨ç”»-->
<script type="text/javascript" th:src="@{/lixa/static/js/ribbon.js}"></script>


<!--LayUI-->
<script th:src="@{/layui/layui.all.js}"></script>

<script type="text/javascript">

    function doQuery(pageNum){

        //formè¡¨å•ä¸­å«æœ‰é¡µæ•°ï¼Œé»˜è®¤ç¬¬1é¡µ
        // document.forms[0].pageNum.value = pageNum;
        $('#sPageNum').val(pageNum);
        $('#actForm').submit();
    }

    function signUpAct(actId){ //æŠ¥åæ´»åŠ¨
        $.ajax({
            type:'POST',
            url:'/user/signUpAct',
            data:{
                actId:actId
            },
            success:function (res){
                if (res.code === '0'){
                    layer.msg("æŠ¥åæˆåŠŸ",{icon:1});
                }else if (res.code === '-1'){
                    layer.confirm(res.msg,{
                        icon:0,title:'å‹æƒ…æé†’',
                        btn: ['ç™»é™†å»', 'æš‚ä¸']
                    }, function () {
                        // æŒ‰é’®1çš„äº‹ä»¶
                        window.location.href = "/user";
                    }, function(){
                        // æŒ‰é’®2çš„äº‹ä»¶
                        layer.close();//å…³é—­çª—å£
                    });
                }else if(res.code === '-2'){
                    layer.msg(res.msg,{icon:2});
                }
            }
        })
    }

    function signUpActModel(){

        const  actIdHide  = $('#actIdHide').val();//å¾—åˆ°éšè—çš„æ´»åŠ¨id
        signUpAct(actIdHide);
    }
    function actDtl(actId){

        $.ajax({
            type:'GET',
            url: '/user/actById/'+actId,
            success:function (res){
                if(res.code ==='0'){
                    $('#actImg').attr('src','');
                    $('#actImg').attr('src',res.data.actImg);
                    $('#actThemeI').html(res.data.actTheme);
                    $("#showActDtl").modal('show');
                    $('#actStart').html(res.data.actStart);
                    $('#actEnd').html(res.data.actEnd);
                    $('#actNum').html(res.data.actNum);
                    $('#actDtl').html(res.data.actDtl);
                    $('#actIdHide').val(res.data.actId);
                }
            }
        })
    }

    function myHeart(actId,heartId){
        $.ajax({
            type:'POST',
            url:'/user/actMyHeart',
            data:{
                actId:actId,
                heartId:heartId,
            },
            success:function (res){
                if (res.code === '0'){
                    layer.msg("æ”¶è—æˆåŠŸ",{icon:1});
                    window.location.reload();
                }else if (res.code === '-1'){
                    layer.confirm(res.msg,{
                        icon:0,title:'å‹æƒ…æé†’',
                        btn: ['ç™»é™†å»', 'æš‚ä¸']
                    }, function () {
                        // æŒ‰é’®1çš„äº‹ä»¶
                        window.location.href = "/user";
                    }, function(){
                        // æŒ‰é’®2çš„äº‹ä»¶
                        layer.close();//å…³é—­çª—å£
                    });
                }else if(res.code === '-2'){
                    layer.msg(res.msg,{icon:2});
                }
            }
        })
    }
</script>


<div class="go-top"><i class="bx bx-chevrons-up"></i><i class="bx bx-chevrons-up"></i></div>
<script th:src="@{/lixa/js/jquery.min.js}"></script>
<script th:src="@{/lixa/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/lixa/js/meanmenu.min.js}"></script>
<script th:src="@{/lixa/js/owl.carousel.min.js}"></script>
<script th:src="@{/lixa/js/wow.min.js}"></script>
<script th:src="@{/lixa/js/form-validator.min.js}"></script>
<script th:src="@{/lixa/js/contact-form-script.js}"></script>
<script th:src="@{/lixa/js/ajaxchimp.min.js}"></script>
<script th:src="@{/lixa/js/range-slider.min.js}"></script>
<script th:src="@{/lixa/js/custom.js}"></script>

</body>

</html>