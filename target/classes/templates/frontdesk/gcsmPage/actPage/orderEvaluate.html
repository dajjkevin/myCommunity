<!doctype html>
<html lang="zxx" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <META HTTP-EQUIV='pragma' CONTENT='no-cache'>
    <META HTTP-EQUIV='Cache-Control' CONTENT='no-cache, must-revalidate'>
    <META HTTP-EQUIV='expires' CONTENT='0'>

    <link rel="stylesheet" th:href="@{/lixa/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/owl.theme.default.min.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/owl.carousel.min.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/boxicons.min.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/flaticon.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/meanmenu.min.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/animate.min.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/style.css}">
    <link rel="stylesheet" th:href="@{/lixa/css/responsive.css}">
    <link rel="icon" type="image/png" th:href="@{/lixa/images/favicon.png}">
    <link rel="icon" href="https://img1.baidu.com/it/u=874447137,1655042583&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500" type="image/png">

    <!--layui-->
    <link rel="stylesheet" th:href="@{/layui/css/layui.css}">

    <!-- ÊòüÁ∫ß -->
    <!--    <link type="text/css" rel="stylesheet" th:href="@{/raty/demo/css/application.css}">-->
    <!--    <script type="text/javascript" th:href="@{/raty/demo/js/jquery.min.js}"></script>-->
    <!--    <script type="text/javascript" th:href="@{/raty/lib/jquery.raty.min.js}"></script>-->

    <title>Á§æÂå∫Ê¥ªÂä®</title>
</head>

<body>
<div class="preloader">
    <div class="lds-ripple">
        <div class="pl-flip-1 pl-flip-2"></div>
    </div>
</div>

<!--header start-->
<div  th:insert="~{frontdeskcommons/nav/head :: myhead}"></div>
<!--header end-->

<div>
    <!--    <h2 style="text-align: center;margin-top: 3%;margin-bottom: 3%">ÊúçÂä°ËØ¶ÊÉÖ</h2>-->
</div>


<!--‰ºò‰∫´ÊúçÂä°-->
<section class="shop-details-area ptb-100">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6 col-md-12">
                <div class="shop-details-image"><img th:src="${evalByOrderId.serve.serveImg}" width="400px" height="400px" alt="Image"></div>
            </div>
            <div class="col-lg-6 col-md-12">
                <div class="shop-details-desc">
                    <h3 th:text="${evalByOrderId.type.typeName}"></h3>
                    <div class="shop-review">
                        <div class="rating">
                            <i class='bx bxs-star'></i>
                            <i class='bx bxs-star'></i>
                            <i class='bx bxs-star'></i>
                            <i class='bx bxs-star'></i>
                            <i class='bx bxs-star'></i>
                        </div><a class="rating-count">(3 Customer reviews)</a>
                    </div>
                    <div class="price"><span class="new-price" th:text="'Ôø•'+${evalByOrderId.serve.serveMoney}"></span></div>
                    <p><i class="bx bx-phone-call" th:text="'Ôºö'+${evalByOrderId.serve.phone}"></i></p>
                    <p><i class="bx bx-user" th:text="'Ôºö'+${evalByOrderId.serve.serveName}"></i></p>
                    <!--                    <br><br>-->
                    <!--                    <button type="submit" class="default-btn">Âè´ÊúçÂä°</button>-->
                </div>
            </div>
            <div class="col-lg-12 col-md-12">
                <div class="tab shop-details-tab">
                    <div class="row">
                        <div class="col-lg-12 col-md-12">
                            <ul class="tabs">
                                <li id="evalInfo" th:onclick="fontChangeColor('userpj')">ÂÖ∂‰ªñËØÑ‰ª∑([[${allEvaluate.total}]])</li>
                                <li th:if="${evalByOrderId.evaluate?.eStatus} != '0'" th:onclick="fontChangeColor('pj')" id="pj">ËØÑ‰ª∑</li>
                                <li th:if="${evalByOrderId.evaluate?.eStatus} == '0'" th:onclick="fontChangeColor('mypj')"v id="mypj">ÊàëÁöÑËØÑËÆ∫</li>
                            </ul>
                        </div>
                        <div class="col-lg-12 col-md-12">
                            <div class="tab_content">
                                <!--ÊâÄÊúâÁî®Êà∑ËØÑ‰ª∑-->
                                <div class="tabs_item">
                                    <div class="shop-details-tab-content">
                                        <div class="shop-review-form">
                                            <div class="review-comments" th:if="${not #lists.isEmpty(allEvaluate)}" th:each="allEvaluate:${allEvaluate.records}">
                                                <div class="review-item">
                                                    <div class="logo">
                                                        <img th:src="${allEvaluate.user?.userAvatar}==null?'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fi.qqkou.com%2Fi%2F0a1406481394x2846025398b26.jpg&refer=http%3A%2F%2Fi.qqkou.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1649253947&t=deede54935f706da8c8eee1dccfb345c':${allEvaluate.user?.userAvatar}"  style="width: 50px;height: 50px">
                                                    </div>
                                                    <div class="rating" th:text="${allEvaluate.user?.userName}">Áî®Êà∑Âêç</div>
                                                    <div class="rating"  style="margin-left: 70%" th:text="${#dates.format(allEvaluate.evaluate?.eTime,'yyyy-MM-dd HH:mm:ss')}">Êó∂Èó¥</div>
                                                    <div class="form-group">
                                                        <p th:id="${allEvaluate.evaluate?.eId} +''+ ${allEvaluate.evaluate?.fraction}">Áî®Êà∑Êª°ÊÑèÂ∫¶</p>
                                                    </div>
                                                    <h3>ËØÑ‰ª∑ÂÜÖÂÆπüëáÔºö</h3>
                                                    <p th:utext="${allEvaluate.evaluate?.content}">Lorem ipsum dolor sit amet,consectetur adipiscing elit,sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,quis nostrud exercitation.</p>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- ËØÑËÆ∫È°µÁ†Å -->
                                        <div class="col-12" th:if="${not #lists.isEmpty(allEvaluate.records)}" style="margin-top: 5%">
                                            <div class="pagination-area text-center">
                                                <a  class="next page-numbers"  th:onclick="|doQuery(1)|" style="cursor: pointer;">È¶ñÈ°µ</a>
                                                <a class="next page-numbers" th:if="${allEvaluate.hasPrevious()}" th:onclick="|doQuery(${allEvaluate.getCurrent()-1})|"><i class="flaticon-left-arrow"></i></a>
                                                <span class="" aria-current="page" th:class="${num == allEvaluate.current} ?'page-numbers current':'page-numbers'"
                                                      th:each="num:${#numbers.sequence(1,allEvaluate.pages)}">
                                                      <a th:onclick="|doQuery(${num})|" style="cursor: pointer;">[[${num}]]</a>
                                                </span>
                                                <a  class="next page-numbers" th:if="${allEvaluate.hasNext()}" th:onclick="|doQuery(${allEvaluate.current+1})|"><i class="flaticon-right-arrow"></i></a>
                                                <a  class="next page-numbers"  th:onclick="|doQuery(${allEvaluate.pages})|" style="cursor: pointer;">Êú´È°µ</a>
                                                <p style="text-align: center;">
                                                    ÂΩìÂâçÁ¨¨ [[${allEvaluate.current}]] È°µ,ÂÖ± [[${allEvaluate.pages }]] È°µ,
                                                    ÊÄª [[ ${allEvaluate.total }]] Êù°ËØÑËÆ∫ËÆ∞ÂΩï
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tabs_item">
                                    <div class="shop-details-tab-content">
                                        <div class="shop-review-form">
                                            <div class="review-form">
                                                <!--ÊúçÂä°ËØÑ‰ª∑-->
                                                <form>
                                                    <div class="row" th:if="${evalByOrderId.evaluate?.eStatus} != '0'">
                                                        <div class="col-lg-12 col-md-12">
                                                            <div class="form-group">
                                                                <label>Êª°ÊÑèÂ∫¶</label>
                                                                <div>
                                                                    <p id="startE"></p>
                                                                </div>
                                                            </div>
                                                            <div class="form-group">
                                                                <label>ËØÑ‰ª∑ÂÜÖÂÆπ</label>
                                                                <div id="evalEditor" style="height:400px;max-height:325px;">
                                                                    <p id="evalContent">ËØÑËÆ∫Êú¨Ê¨°ÊúçÂä°‰∏éÂª∫ËÆÆ,ËÆ©Êàë‰ª¨‰ª•ÂèØÂÅöÁöÑÊõ¥Â•ΩÔºÅ</p>
                                                                </div>
                                                                <!--<textarea name="review-body" id="review-body" cols="30" rows="8" class="form-control"></textarea>-->
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-12 col-md-12">
                                                            <button type="button" class="btn default-btn two" th:onclick="addAval([[${evalByOrderId.orderId}]])" id="addAvalId">Êèê‰∫§</button>
                                                        </div>
                                                    </div>
                                                </form>
                                                <!-- ÊàëÁöÑËØÑ‰ª∑-->
                                                <div class="row" th:if="${evalByOrderId.evaluate?.eStatus} == '0'">
                                                    <h3 style="text-align: center;color: #b3eef8" >ËØ•ÊúçÂä°Â∑≤ËØÑ‰ª∑</h3>
                                                    <div class="review-item">
                                                        <div class="logo">
                                                            <img th:src="${session.userFrontDesk?.userAvatar}==null?'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fi.qqkou.com%2Fi%2F0a1406481394x2846025398b26.jpg&refer=http%3A%2F%2Fi.qqkou.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1649253947&t=deede54935f706da8c8eee1dccfb345c':${session.userFrontDesk?.userAvatar}"  style="width: 50px;height: 50px">
                                                        </div>
                                                        <h3 class="rating" th:text="${session.userFrontDesk?.userName}">Áî®Êà∑Âêç</h3>
                                                        <div class="form-group">
                                                            <label>Êª°ÊÑèÂ∫¶</label>
                                                            <div>
                                                                <p id="fraction"></p>
                                                            </div>
                                                        </div>
                                                        <div class="rating" id="eTime" style="margin-left: 70%">Êó∂Èó¥</div>
                                                        <h3>ËØÑ‰ª∑ÂÜÖÂÆπüëáÔºö</h3>
                                                        <p id="myContent">Lorem ipsum dolor sit amet,consectetur adipiscing elit,sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,quis nostrud exercitation.</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!--‰ºò‰∫´ÊúçÂä°-->

<!--footer start-->
<div th:insert="~{frontdeskcommons/nav/footer :: myfooter}"></div>
<!--footer end È°µËÑö„ÄÅÈ°µËÑöÈ°µÈù¢ÂÜÖÂÆπ-->

<!--LayUI-->
<script th:src="@{/layui/layui.all.js}"></script>

<!--ËÉåÊôØÂä®Áîª-->
<script type="text/javascript" th:src="@{/lixa/static/js/ribbon.js}"></script>


<!--LayUI-->
<script th:src="@{/layui/layui.all.js}"></script>

<script type="text/javascript">

    function doQuery(pageNum) {

        var orderId = [[${evalByOrderId.orderId}]]
        window.location.href = "/user/evaluateIndex/"+ orderId + "?pageNum=" + pageNum;
    }

    function fontChangeColor(fontFlag){
        $('#mypj,#pj,#evalInfo').css("color","");
        if (fontFlag == 'pj'){
            $('#pj').css("color","#c4ab90");
            $('#pj').css("font-weight","Bold");
        }
        if (fontFlag == 'mypj'){
            $('#mypj').css("color","#c4ab90");
            $('#mypj').css("font-weight","Bold");
        }
        if (fontFlag == 'userpj'){
            $('#evalInfo').css("color","#c4ab90");
            $('#evalInfo').css("font-weight","Bold");
        }

    }

    var pf = "";//ËØÑÂàÜÊòüÁ∫ß
    layui.use('rate', function () {
        var rate = layui.rate;
        pf = rate.render({
            elem:'#startE',
            length: 5            //ÊòüÊòü‰∏™Êï∞
            , value: 4    //ÂàùÂßãÂåñÂÄº
            , theme: ' gold'     //È¢úËâ≤
            // , half: true           //ÊîØÊåÅÂçäÈ¢óÊòü
            , text: true           //ÊòæÁ§∫ÊñáÊú¨
            , setText: function (value) {
                var arrs = {
                    '1':'Âæà‰∏ÄËà¨',
                    '2':'‰∏ÄËà¨',
                    '3':'‰∏≠Á≠â',
                    '4':'Â•Ω',
                    '5':'ÈùûÂ∏∏Â•Ω',
                }
                this.span.text(arrs[value] || (value + "Êòü"));
            }
        })
    });

    function addAval(orderId) {

        var xjData = pf.config.value;//ÊòüÁ∫ß
        var userId = '[[${session.userFrontDesk?.userId}]]';
        var evalContent = editor.txt.html();//ËØÑ‰ª∑ÂÜÖÂÆπ
        var serveId = '[[${evalByOrderId.serve?.serveId}]]';

        $.ajax({
            type: "POST",
            url: '/user/userAddEvaluate',
            data: {
                orderId: orderId,
                userId: userId,
                serveId: serveId,
                content: evalContent,
                fraction: xjData,
            },
            success: function (res) {
                if (res.code == '0') {
                    layer.msg("ËØÑ‰ª∑ÊàêÂäüÔºÅ", {icon: 1});
                    window.location.reload();
                }
            }
        })
    }

    //Ê†ºÂºèÂåñÊó∂Èó¥Êà≥
    function add0(m){return m<10?'0'+m:m }
    function format(shijianchuo)
    {
        var time = new Date(shijianchuo);
        var y = time.getFullYear();
        var m = time.getMonth()+1;
        var d = time.getDate();
        var h = time.getHours();
        var mm = time.getMinutes();
        var s = time.getSeconds();
        return y+'-'+add0(m)+'-'+add0(d)+' '+add0(h)+':'+add0(mm)+':'+add0(s);
    }

    function allFraction(startNum) {

        var split = startNum.split("a");
        var sE0 = split[0];
        var sE1 = split[1];

        layui.use('rate', function () {
            var rate = layui.rate;
            var inAll = rate.render({
                elem: '#'+sE0+sE1         //ÁªëÂÆöÂÖÉÁ¥†ÔºàÔºãaËß£ÂÜ≥‰∏çËÉΩ‰∏∫ÂÖ®Êï∞Â≠óÔºâ
                , length: 5            //ÊòüÊòü‰∏™Êï∞
                , value: sE1    //ÂàùÂßãÂåñÂÄº
                , theme: ' gold'     //È¢úËâ≤
                , text: true           //ÊòæÁ§∫ÊñáÊú¨
                , readonly: true      //Âè™ËØª
                //Ëá™ÂÆö‰πâÊñáÊú¨ÔºåÁÇπÂáªÂêéÊñáÊú¨ÊòæÁ§∫ÁöÑÂÜÖÂÆπ
                , setText: function (value) {
                    var arrs = {
                        '1':'Âæà‰∏ÄËà¨',
                        '2':'‰∏ÄËà¨',
                        '3':'‰∏≠Á≠â',
                        '4':'Â•Ω',
                        '5':'ÈùûÂ∏∏Â•Ω',
                    }
                    this.span.text("Êª°ÊÑèÂ∫¶Ôºö"+arrs[value] || (value + "Êòü"));
                }
            })
        });
    };

    window.onload = function () {
        // $('#pj').click();//Âä†ËΩΩÈ°µÈù¢ÂêéÁÇπÂáªËØÑ‰ª∑
        // $('#mypj').click();//Âä†ËΩΩÈ°µÈù¢ÂêéÁÇπÂáªÊàëÁöÑËØÑ‰ª∑  ÂÖ∂‰∏≠‰∏Ä‰∏™

        var eId = '[[${evalByOrderId.evaluate?.eId}]]';
        if (eId != "" && eId != null && eId != undefined) {
            $.ajax({
                type: "GET",
                url: "/user/userEvalById",
                data: {
                    eId: eId
                },
                success: function (res) {
                    $('#eTime').html(format(res.data.etime));
                    $('#myContent').html(res.data.content);
                    var fractionE = res.data.fraction;

                    layui.use('rate', function () {
                        var rate = layui.rate;
                        var ins1 = rate.render({
                            elem: '#fraction'       //ÁªëÂÆöÂÖÉÁ¥†ÔºàÔºãaËß£ÂÜ≥‰∏çËÉΩ‰∏∫ÂÖ®Êï∞Â≠óÔºâ
                            , length: 5            //ÊòüÊòü‰∏™Êï∞
                            , value: fractionE    //ÂàùÂßãÂåñÂÄº
                            , theme: ' gold'     //È¢úËâ≤
                            , text: true           //ÊòæÁ§∫ÊñáÊú¨
                            , readonly: true      //Âè™ËØª
                            //Ëá™ÂÆö‰πâÊñáÊú¨ÔºåÁÇπÂáªÂêéÊñáÊú¨ÊòæÁ§∫ÁöÑÂÜÖÂÆπ
                            , setText: function (value) {
                                var arrs = {
                                    '1':'Âæà‰∏ÄËà¨',
                                    '2':'‰∏ÄËà¨',
                                    '3':'‰∏≠Á≠â',
                                    '4':'Â•Ω',
                                    '5':'ÈùûÂ∏∏Â•Ω',
                                }
                                this.span.text(arrs[value] || (value + "Êòü"));
                            }
                        })
                    });
                }
            });
        }

        $.ajax({
            url:'/user/userListEval',
            success:function (res){
                var total = res.data.length;
                for (var i=0;i<total;i++){
                    allFraction(res.data[i].eid+"a"+res.data[i].fraction);
                }
            }
        });

    }


    var E = window.wangEditor
    var editor = new E('#evalEditor')
    // ÊàñËÄÖ var editor = new E( document.getElementById('editor') )
    // ÈÖçÁΩÆÊúçÂä°Âô®Á´ØÂú∞ÂùÄ
    editor.customConfig.uploadImgServer = 'http://localhost:8080/upload/editor'
    //ÈÖçÁΩÆÊåáÂÆöÊñá‰ª∂Âêç
    editor.customConfig.uploadFileName = 'file'

    //Â¶ÇÊûúÂõæÁâá‰∏çÂ§ßÔºåÂèØ‰ª•Áî®base64Â≠òÂÇ®
    // editor.customConfig.uploadImgShowBase64 = true

    editor.create()

</script>


<div class="go-top"><i class="bx bx-chevrons-up"></i><i class="bx bx-chevrons-up"></i></div>
<script th:src="@{/lixa/js/jquery.min.js}"></script>
<script th:src="@{/lixa/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/lixa/js/meanmenu.min.js}"></script>
<script th:src="@{/lixa/js/owl.carousel.min.js}"></script>
<script th:src="@{/lixa/js/wow.min.js}"></script>
<script th:src="@{/lixa/js/form-validator.min.js}"></script>
<script th:src="@{/lixa/js/contact-form-script.js}"></script>
<script th:src="@{/lixa/js/ajaxchimp.min.js}"></script>
<script th:src="@{/lixa/js/range-slider.min.js}"></script>
<script th:src="@{/lixa/js/custom.js}"></script>

</body>

</html>